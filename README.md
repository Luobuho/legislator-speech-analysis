# 🏛️ 立法委員主題分析系統

基於BERTopic深度分析立法委員發言主題與影響力的綜合分析平台

## 📋 目錄

- [系統概述](#系統概述)
- [核心功能](#核心功能)
- [技術架構](#技術架構)
- [安裝與部署](#安裝與部署)
- [使用說明](#使用說明)
- [數據說明](#數據說明)
- [指標解釋](#指標解釋)
- [文件結構](#文件結構)
- [更新日誌](#更新日誌)

## 🎯 系統概述

本系統是一個基於BERTopic主題建模技術的立法委員發言分析平台，通過深度學習和網絡分析技術，從立法委員的發言內容中提取主題、分析關心度、計算影響力，並提供直觀的可視化界面。

### 主要特色

- **🤖 AI驅動**: 使用BERTopic進行主題自動發現和分類
- **📊 多維分析**: 立委-主題匹配、影響力分析、社群檢測
- **🎨 互動可視化**: 響應式網頁界面，支持實時篩選和排序
- **📈 量化指標**: 標準化評分系統，便於比較分析
- **🔍 智能搜索**: 支持立委、主題、政黨等多維度搜索

## 🚀 核心功能

### 1. 立委主題匹配分析
- **雙向匹配**: 立委→主題 和 主題→立委 的雙向分析
- **關心度量化**: 基於直接發言、相關性分布的綜合評分
- **動態閾值**: 根據數據分布自動調整相關性判定標準

### 2. 相關性計算分析

#### 主題分數計算
- **直接發言次數**: 立委被直接分配到該主題的發言次數
- **低/中/高相關發言次數**: 基於動態閾值的分層統計
  - 低相關: > 平均值 + 1.0×標準差
  - 中相關: > 平均值 + 2.0×標準差  
  - 高相關: > 平均值 + 3.0×標準差
- **最終關心度評分**: 基礎關心度 + 加權關心度 + 質量加分

#### 立委綜合評分
- **專業度**: 總關心度/關注主題數，衡量專精程度
- **發言效率**: 總關心度/總發言次數，反映發言質量
- **關注主題數**: 符合以下任一條件的主題數量：
  - 有直接發言
  - 有高相關發言
  - 有2個以上中相關發言且平均相關性超過中閾值
  - 有5個以上低相關發言且平均、最大相關性達標
  - 最終關心度評分超過3.0

### 3. 影響力分析

#### 基礎指標（保持原始計算）
- **度中心性**: 直接連接數量，反映直接影響範圍
- **加權度中心性**: 考慮連接權重的度中心性

#### 會議加權指標（創新功能）
- **會議加權介數中心性**: 原值 × log(會議數+1)，重視活躍參與者的橋樑作用
- **會議加權LeaderRank**: 原值 × log(會議數+1)，突出會議中的領導者
- **會議加權特徵向量中心性**: 原值 × log(會議數+1)，重視重要會議網絡
- **會議加權核數**: 原值 × log(會議數+1)，突出核心討論圈的積極參與者

### 4. 社群分析

#### 雙模式分群
1. **共同出席會議分群**: 基於立委參與相同會議的頻率
2. **發言內容分群**: 基於立委發言主題的語義相似度

#### 分析功能
- **實時切換**: 支持兩種分群方法的即時切換
- **重新分析**: 可觸發重新計算社群結構
- **多維展示**: 顯示社群規模、密度、主要政黨、共同關注主題

### 5. 政黨與選區分析
- **政黨主題偏好**: 各政黨關注主題的統計分析
- **選區議題特色**: 不同選區立委的議題關注特點
- **原籍地影響**: 立委原籍地與議題關注的關聯分析

## 🛠️ 技術架構

### 後端分析引擎
- **Python 3.8+**
- **BERTopic**: 主題建模核心
- **NetworkX**: 網絡分析和社群檢測
- **Pandas**: 數據處理和分析
- **Scikit-learn**: 機器學習和聚類
- **Matplotlib/Plotly**: 可視化生成

### 前端展示系統
- **HTML5 + CSS3**: 響應式界面設計
- **Vanilla JavaScript**: 純原生JS，無框架依賴
- **Chart.js/Plotly.js**: 互動式圖表
- **Bootstrap風格**: 現代化UI設計

### 數據處理流程
```mermaid
graph LR
    A[原始發言數據] --> B[文本預處理]
    B --> C[BERTopic主題建模]
    C --> D[機率分布計算]
    D --> E[相關性矩陣]
    E --> F[網絡構建]
    F --> G[影響力計算]
    G --> H[可視化展示]
```

## 📖 使用說明

### 數據準備
1. **立委發言數據**: CSV格式，包含委員姓名、發言內容、會議檔案等欄位
2. **委員資訊對應表**: 包含委員姓名、政黨、選區、原籍等資訊
3. **確保數據編碼**: 建議使用UTF-8編碼

### 分析流程

#### 步驟1: BERTopic主題分析
```bash
python bertopic_analysis_complete.py
```
輸出文件：
- `topic_info.csv`: 主題資訊和關鍵詞
- `legislator_topic_interest.csv`: 立委主題關心度
- `legislator_comprehensive_stats.csv`: 立委綜合統計

#### 步驟2: 網絡影響力分析
```bash
python legislator_network_analysis.py
```
輸出文件：
- `立法委員網絡分析_會議加權.csv`: 會議加權影響力指標
- `主題立法委員映射.csv`: 主題與立委對應關係

#### 步驟3: 網頁界面使用
1. 啟動本地服務器
2. 瀏覽器訪問界面
3. 使用各功能標籤頁進行分析

### 界面操作指南

#### 導航標籤
- **立委主題匹配**: 查看立委關注的主題
- **主題立委匹配**: 查看主題的關注立委
- **黨派主題分析**: 分析各政黨的議題偏好
- **選區原籍分析**: 地理因素與議題關注的關係
- **相關性計算**: 詳細的量化指標說明
- **影響力分析**: 網絡中心性和會議加權指標
- **社群分析**: 立委群體結構和關係
- **可視化分析**: 互動式圖表和視覺化

#### 搜索與篩選
- **關鍵詞搜索**: 支持立委姓名、主題關鍵詞搜索
- **政黨篩選**: 按政黨分類查看數據
- **排序功能**: 點擊表頭進行升降序排序
- **數據導出**: 支持當前視圖或全部數據的CSV導出

## 📊 數據說明

### 輸入數據格式

#### 立委發言數據 (`documents.csv`)
| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 委員姓名 | 發言立委姓名 | 王○○ |
| segmented_content | 分詞後的發言內容 | 經濟 發展 政策 討論 |
| file | 會議檔案名稱 | meeting_001.txt |

#### 委員資訊對應表 (`member_mapping.csv`)
| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 原始姓名 | 立委真實姓名 | 王○○ |
| 政黨 | 所屬政黨 | 民進黨 |
| 選區 | 選舉區域 | 台北市第一選區 |
| 原籍 | 出生地或祖籍 | 台北市 |

### 輸出數據格式

#### 立委主題關心度 (`legislator_topic_interest.csv`)
| 欄位名稱 | 說明 | 數值範圍 |
|---------|------|----------|
| 委員姓名 | 立委姓名 | - |
| 主題ID | 主題編號 | 0-174 |
| 直接發言次數 | 直接分配到該主題的發言數 | ≥0 |
| 最終關心度評分 | 綜合評分 | ≥0 |
| 平均相關性 | 平均機率分數 | 0-1 |

## 🔍 指標解釋

### 相關性計算指標

#### 動態閾值設定
系統根據實際數據分布動態設定閾值，確保只選擇真正突出的關聯：

```python
# 統計方法計算閾值
low_threshold = mean + 1.0 * std     # 約84%分位數
medium_threshold = mean + 2.0 * std  # 約97.5%分位數  
high_threshold = mean + 3.0 * std    # 約99.7%分位數

# 合理界限
low_threshold = max(low_threshold, mean * 1.5)
medium_threshold = max(medium_threshold, mean * 2.5)
high_threshold = max(high_threshold, mean * 4.0)
```

#### 最終關心度評分公式
```
最終關心度 = 基礎關心度 + 加權關心度 + 質量加分
其中：
- 基礎關心度 = 直接發言次數 × 2.0
- 加權關心度 = 總相關性 × 1.0  
- 質量加分 = 高相關發言次數 × 0.5
```

### 會議加權影響力指標

#### 加權計算公式
```
會議加權指標 = 原始指標 × log(會議參與數 + 1)
```

使用對數函數的原因：
1. **避免極值影響**: 防止會議數過多的立委指標過度膨脹
2. **保持相對關係**: 維持原始指標的相對重要性
3. **合理加權**: 體現會議參與的邊際遞減效應

#### 指標意義說明

| 指標名稱 | 計算方法 | 實際意義 |
|---------|---------|----------|
| 度中心性 | 直接連接數/總節點數 | 直接影響範圍 |
| 介數中心性(會議加權) | 原值×log(會議數+1) | 重視活躍參與者的橋樑作用 |
| LeaderRank(會議加權) | 原值×log(會議數+1) | 突出會議中的實際領導者 |
| 特徵向量中心性(會議加權) | 原值×log(會議數+1) | 重視在重要會議網絡中的地位 |

### 社群分析方法

#### 共同出席會議分群
- **算法**: Louvain模組最佳化算法
- **基礎**: 立委間共同參與會議的頻率
- **優點**: 反映實際互動關係
- **適用**: 分析政治聯盟和合作關係

#### 發言內容分群  
- **算法**: K-means聚類
- **基礎**: 立委發言主題的語義相似度
- **優點**: 反映議題立場相似性
- **適用**: 分析政策偏好和理念分組

## 📧 聯繫方式

- **技術支持**: [技術團隊郵箱]
- **問題反饋**: [GitHub Issues]
- **功能建議**: [討論區連結]
